"""
Simple localization helper for the live view app.
Supports basic key-based translations with runtime locale switching.
"""
from typing import Dict

DEFAULT_LOCALE = "en"
_locale = DEFAULT_LOCALE

TRANSLATIONS: Dict[str, Dict[str, str]] = {
    "en": {
        "app_title": "StudioTether",
        "status_not_connected": "Not connected",
        "status_streaming": "Streaming",
        "status_error": "Error: {msg}",
        "snackbar_failed_connect": "Failed to connect: {msg}",
        "status_disconnected": "Disconnected",
        "status_io_busy": "I/O busy, retrying...",
        "status_disconnected_io": "Disconnected (I/O errors)",
        "status_disconnected_device": "Disconnected (device unplugged)",
        "status_disconnected_short": "Disconnected: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "Rotation 0Â° â€” key 1",
        "tooltip_rotation_90": "Rotation 90Â° â€” key 2",
        "tooltip_rotation_180": "Rotation 180Â° â€” key 3",
        "tooltip_rotation_270": "Rotation 270Â° â€” key 4",
        "tooltip_autorotate": "Toggle auto-rotate",
        "preview_mode": "Preview",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "Preview 3 seconds â€” key 8",
        "tooltip_duration_10s": "Preview 10 seconds â€” key 9",
        "tooltip_duration_inf": "Preview always â€” key 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "No guides â€” key G",
        "tooltip_guide_thirds": "Rule of thirds â€” key G",
        "tooltip_guide_golden": "Golden ratio â€” key G",
        "tooltip_guide_grid": "Grid 3Ã—3 â€” key G",
        "tooltip_guide_diagonal": "Diagonals â€” key G",
        "tooltip_guide_center": "Center cross â€” key G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normal",
        "guide_fibonacci_variant_vflip": "Spiegeln â†”",
        "guide_fibonacci_variant_hflip": "Spiegeln â†•",
        "guide_fibonacci_variant_both": "Spiegeln â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Fibonacci spiral â€” key G",
        "tooltip_guide_triangles": "Golden triangles â€” key G",
        "tooltip_guide_triangles_flip": "Golden triangles flipped â€” key G",
        "color_white_label": "W",
        "color_green_label": "G",
        "color_red_label": "R",
        "color_black_label": "B",
        "tooltip_color_white": "White guides â€” key C",
        "tooltip_color_green": "Green guides â€” key C",
        "tooltip_color_red": "Red guides â€” key C",
        "tooltip_color_black": "Black guides â€” key C",
        "help_text": "1 / Numpad1 / Digit1 â€” Rotation 0Â°\n2 / Numpad2 / Digit2 â€” Rotation 90Â°\n3 / Numpad3 / Digit3 â€” Rotation 180Â°\n4 / Numpad4 / Digit4 â€” Rotation 270Â°\n8 / Numpad8 / Digit8 â€” Preview duration 3s\n9 / Numpad9 / Digit9 â€” Preview duration 10s\n0 / Numpad0 / Digit0 â€” Preview always (infinite)\nG â€” Cycle composition guides (Shift+G reverse)\nC â€” Cycle guide color\nSpace â€” Toggle preview mode / return to live view\nâ† / â†’ â€” Previous / Next preview image (in preview mode)\nF â€” Toggle full-screen mode\nH â€” Show / hide this help overlay\nA â€” Toggle auto-rotate",
    },
    "pl": {
        "app_title": "StudioTether",
        "status_not_connected": "Nie poÅ‚Ä…czono",
        "status_streaming": "Transmisja",
        "status_error": "BÅ‚Ä…d: {msg}",
        "snackbar_failed_connect": "Nie udaÅ‚o siÄ™ poÅ‚Ä…czyÄ‡: {msg}",
        "status_disconnected": "RozÅ‚Ä…czono",
        "status_io_busy": "ZajÄ™te I/O, ponawiam...",
        "status_disconnected_io": "RozÅ‚Ä…czono (bÅ‚Ä™dy I/O)",
        "status_disconnected_device": "RozÅ‚Ä…czono (urzÄ…dzenie odÅ‚Ä…czone)",
        "status_disconnected_short": "RozÅ‚Ä…czono: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "ObrÃ³t 0Â° â€” klawisz 1",
        "tooltip_rotation_90": "ObrÃ³t 90Â° â€” klawisz 2",
        "tooltip_rotation_180": "ObrÃ³t 180Â° â€” klawisz 3",
        "tooltip_rotation_270": "ObrÃ³t 270Â° â€” klawisz 4",
        "tooltip_autorotate": "WÅ‚Ä…cz/wyÅ‚Ä…cz auto-obrÃ³t",
        "preview_mode": "PodglÄ…d",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "PodglÄ…d 3 sekundy â€” klawisz 8",
        "tooltip_duration_10s": "PodglÄ…d 10 sekund â€” klawisz 9",
        "tooltip_duration_inf": "PodglÄ…d zawsze â€” klawisz 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Bez prowadnic â€” klawisz G",
        "tooltip_guide_thirds": "ReguÅ‚a trÃ³jpodziaÅ‚u â€” klawisz G",
        "tooltip_guide_golden": "ZÅ‚oty podziaÅ‚ â€” klawisz G",
        "tooltip_guide_grid": "Siatka 3Ã—3 â€” klawisz G",
        "tooltip_guide_diagonal": "PrzekÄ…tne â€” klawisz G",
        "tooltip_guide_center": "KrzyÅ¼ centralny â€” klawisz G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Nie odbijaj",
        "guide_fibonacci_variant_vflip": "Odbij â†”",
        "guide_fibonacci_variant_hflip": "Odbij â†•",
        "guide_fibonacci_variant_both": "Odbij â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Spirala Fibonacciego â€” klawisz G",
        "tooltip_guide_triangles": "ZÅ‚ote trÃ³jkÄ…ty â€” klawisz G",
        "tooltip_guide_triangles_flip": "ZÅ‚ote trÃ³jkÄ…ty odwrÃ³cone â€” klawisz G",        "color_white_label": "B",
        "color_green_label": "Z",
        "color_red_label": "C",
        "color_black_label": "Cz",
        "tooltip_color_white": "BiaÅ‚e prowadnice â€” klawisz C",
        "tooltip_color_green": "Zielone prowadnice â€” klawisz C",
        "tooltip_color_red": "Czerwone prowadnice â€” klawisz C",
        "tooltip_color_black": "Czarne prowadnice â€” klawisz C",
        "help_text": "1 / Numpad1 / Digit1 â€” ObrÃ³t 0Â°\n2 / Numpad2 / Digit2 â€” ObrÃ³t 90Â°\n3 / Numpad3 / Digit3 â€” ObrÃ³t 180Â°\n4 / Numpad4 / Digit4 â€” ObrÃ³t 270Â°\n8 / Numpad8 / Digit8 â€” PodglÄ…d 3s\n9 / Numpad9 / Digit9 â€” PodglÄ…d 10s\n0 / Numpad0 / Digit0 â€” PodglÄ…d zawsze (nieskoÅ„czony)\nG â€” PrzeÅ‚Ä…cz prowadnice (Shift+G wstecz)\nC â€” ZmieÅ„ kolor prowadnic\nSpacja â€” PrzeÅ‚Ä…cz podglÄ…d / powrÃ³t do live\nâ† / â†’ â€” Poprzednie / NastÄ™pne zdjÄ™cie podglÄ…du\nF â€” Tryb peÅ‚noekranowy\nH â€” PokaÅ¼/ukryj pomoc\nA â€” WÅ‚Ä…cz/wyÅ‚Ä…cz auto-obrÃ³t",
    },
    "de": {
        "app_title": "StudioTether",
        "status_not_connected": "Nicht verbunden",
        "status_streaming": "Streaming",
        "status_error": "Fehler: {msg}",
        "snackbar_failed_connect": "Verbindung fehlgeschlagen: {msg}",
        "status_disconnected": "Getrennt",
        "status_io_busy": "E/A beschÃ¤ftigt, erneuter Versuch...",
        "status_disconnected_io": "Getrennt (E/A-Fehler)",
        "status_disconnected_device": "Getrennt (GerÃ¤t getrennt)",
        "status_disconnected_short": "Getrennt: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "Drehung 0Â° â€” Taste 1",
        "tooltip_rotation_90": "Drehung 90Â° â€” Taste 2",
        "tooltip_rotation_180": "Drehung 180Â° â€” Taste 3",
        "tooltip_rotation_270": "Drehung 270Â° â€” Taste 4",
        "tooltip_autorotate": "Automatische Drehung ein/aus",
        "preview_mode": "Vorschau",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "Vorschau 3 Sekunden â€” Taste 8",
        "tooltip_duration_10s": "Vorschau 10 Sekunden â€” Taste 9",
        "tooltip_duration_inf": "Vorschau immer â€” Taste 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Keine Hilfslinien â€” Taste G",
        "tooltip_guide_thirds": "Drittelregel â€” Taste G",
        "tooltip_guide_golden": "Goldener Schnitt â€” Taste G",
        "tooltip_guide_grid": "Raster 3Ã—3 â€” Taste G",
        "tooltip_guide_diagonal": "Diagonalen â€” Taste G",
        "tooltip_guide_center": "Mittelkreuz â€” Taste G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normal",
        "guide_fibonacci_variant_vflip": "Flip â†”",
        "guide_fibonacci_variant_hflip": "Flip â†•",
        "guide_fibonacci_variant_both": "Flip â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Fibonacci-Spirale â€” Taste G",
        "tooltip_guide_triangles": "Goldene Dreiecke â€” Taste G",
        "tooltip_guide_triangles_flip": "Goldene Dreiecke gespiegelt â€” Taste G",
        "color_white_label": "W",
        "color_green_label": "G",
        "color_red_label": "R",
        "color_black_label": "S",
        "tooltip_color_white": "WeiÃŸe Hilfslinien â€” Taste C",
        "tooltip_color_green": "GrÃ¼ne Hilfslinien â€” Taste C",
        "tooltip_color_red": "Rote Hilfslinien â€” Taste C",
        "tooltip_color_black": "Schwarze Hilfslinien â€” Taste C",
        "help_text": "1 / Numpad1 / Digit1 â€” Rotation 0Â°\n2 / Numpad2 / Digit2 â€” Rotation 90Â°\n3 / Numpad3 / Digit3 â€” Rotation 180Â°\n4 / Numpad4 / Digit4 â€” Rotation 270Â°\n8 / Numpad8 / Digit8 â€” Vorschau 3s\n9 / Numpad9 / Digit9 â€” Vorschau 10s\n0 / Numpad0 / Digit0 â€” Vorschau immer (unendlich)\nG â€” FÃ¼hrungen wechseln (Shift+G rÃ¼ckwÃ¤rts)\nC â€” FÃ¼hrungsfarbe wechseln\nLeertaste â€” Vorschau umschalten / zurÃ¼ck zur Live-Ansicht\nâ† / â†’ â€” Vorheriges / NÃ¤chstes Vorschaubild\nF â€” Vollbild umschalten\nH â€” Hilfe ein-/ausblenden\nA â€” Automatische Drehung ein/aus",
    },
    "fr": {
        "app_title": "StudioTether",
        "status_not_connected": "Non connectÃ©",
        "status_streaming": "Diffusion en cours", 
        "status_error": "Erreur : {msg}",
        "snackbar_failed_connect": "Ã‰chec de la connexion : {msg}",
        "status_disconnected": "DÃ©connectÃ©",
        "status_io_busy": "E/S occupÃ©es, nouvelle tentative...",
        "status_disconnected_io": "DÃ©connectÃ© (erreurs E/S)",
        "status_disconnected_device": "DÃ©connectÃ© (appareil dÃ©branchÃ©)",
        "status_disconnected_short": "DÃ©connectÃ© : {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "Rotation 0Â° â€” touche 1",
        "tooltip_rotation_90": "Rotation 90Â° â€” touche 2",
        "tooltip_rotation_180": "Rotation 180Â° â€” touche 3",
        "tooltip_rotation_270": "Rotation 270Â° â€” touche 4",
        "tooltip_autorotate": "Activer/dÃ©sactiver la rotation auto",
        "preview_mode": "AperÃ§u",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "AperÃ§u 3 secondes â€” touche 8",
        "tooltip_duration_10s": "AperÃ§u 10 secondes â€” touche 9",
        "tooltip_duration_inf": "AperÃ§u toujours â€” touche 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Sans guides â€” touche G",
        "tooltip_guide_thirds": "RÃ¨gle des tiers â€” touche G",
        "tooltip_guide_golden": "Nombre d'or â€” touche G",
        "tooltip_guide_grid": "Grille 3Ã—3 â€” touche G",
        "tooltip_guide_diagonal": "Diagonales â€” touche G",
        "tooltip_guide_center": "Croix centrale â€” touche G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "ÐÐ¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹",
        "guide_fibonacci_variant_vflip": "ÐžÑ‚Ñ€Ð°Ð·Ð¸Ñ‚ÑŒ â†”",
        "guide_fibonacci_variant_hflip": "ÐžÑ‚Ñ€Ð°Ð·Ð¸Ñ‚ÑŒ â†•",
        "guide_fibonacci_variant_both": "ÐžÑ‚Ñ€Ð°Ð·Ð¸Ñ‚ÑŒ â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Spirale de Fibonacci â€” touche G",
        "tooltip_guide_triangles": "Triangles d'or â€” touche G",
        "tooltip_guide_triangles_flip": "Triangles d'or inversÃ©s â€” touche G",
        "color_white_label": "B",
        "color_green_label": "V",
        "color_red_label": "R",
        "color_black_label": "N",
        "tooltip_color_white": "Guides blancs â€” touche C",
        "tooltip_color_green": "Guides verts â€” touche C",
        "tooltip_color_red": "Guides rouges â€” touche C",
        "tooltip_color_black": "Guides noirs â€” touche C",
        "help_text": "1 / Numpad1 / Digit1 â€” Rotation 0Â°\n2 / Numpad2 / Digit2 â€” Rotation 90Â°\n3 / Numpad3 / Digit3 â€” Rotation 180Â°\n4 / Numpad4 / Digit4 â€” Rotation 270Â°\n8 / Numpad8 / Digit8 â€” AperÃ§u 3s\n9 / Numpad9 / Digit9 â€” AperÃ§u 10s\n0 / Numpad0 / Digit0 â€” AperÃ§u toujours (infini)\nG â€” Parcourir guides de composition (Shift+G inverse)\nC â€” Changer la couleur des guides\nEspace â€” Basculer aperÃ§u / revenir en direct\nâ† / â†’ â€” PrÃ©cÃ©dent / Suivant (en mode aperÃ§u)\nF â€” Basculer plein Ã©cran\nH â€” Afficher/masquer cette aide\nA â€” Activer/dÃ©sactiver la rotation auto",
    },
    "es": {
        "app_title": "StudioTether",
        "status_not_connected": "No conectado",
        "status_streaming": "TransmisiÃ³n", 
        "status_error": "Error: {msg}",
        "snackbar_failed_connect": "Error al conectar: {msg}",
        "status_disconnected": "Desconectado",
        "status_io_busy": "E/S ocupada, reintentando...",
        "status_disconnected_io": "Desconectado (errores de E/S)",
        "status_disconnected_device": "Desconectado (dispositivo desconectado)",
        "status_disconnected_short": "Desconectado: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "RotaciÃ³n 0Â° â€” tecla 1",
        "tooltip_rotation_90": "RotaciÃ³n 90Â° â€” tecla 2",
        "tooltip_rotation_180": "RotaciÃ³n 180Â° â€” tecla 3",
        "tooltip_rotation_270": "RotaciÃ³n 270Â° â€” tecla 4",
        "tooltip_autorotate": "Alternar rotaciÃ³n automÃ¡tica",
        "preview_mode": "Vista previa",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "Vista previa 3 segundos â€” tecla 8",
        "tooltip_duration_10s": "Vista previa 10 segundos â€” tecla 9",
        "tooltip_duration_inf": "Vista previa siempre â€” tecla 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Sin guÃ­as â€” tecla G",
        "tooltip_guide_thirds": "Regla de tercios â€” tecla G",
        "tooltip_guide_golden": "ProporciÃ³n Ã¡urea â€” tecla G",
        "tooltip_guide_grid": "CuadrÃ­cula 3Ã—3 â€” tecla G",
        "tooltip_guide_diagonal": "Diagonales â€” tecla G",
        "tooltip_guide_center": "Cruz central â€” tecla G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normaal",
        "guide_fibonacci_variant_vflip": "Spiegelen â†”",
        "guide_fibonacci_variant_hflip": "Spiegelen â†•",
        "guide_fibonacci_variant_both": "Spiegelen â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Espiral de Fibonacci â€” tecla G",
        "tooltip_guide_triangles": "TriÃ¡ngulos dorados â€” tecla G",
        "tooltip_guide_triangles_flip": "TriÃ¡ngulos dorados invertidos â€” tecla G",
        "color_white_label": "B",
        "color_green_label": "V",
        "color_red_label": "R",
        "color_black_label": "N",
        "tooltip_color_white": "GuÃ­as blancas â€” tecla C",
        "tooltip_color_green": "GuÃ­as verdes â€” tecla C",
        "tooltip_color_red": "GuÃ­as rojas â€” tecla C",
        "tooltip_color_black": "GuÃ­as negras â€” tecla C",
        "help_text": "1 / Numpad1 / Digit1 â€” RotaciÃ³n 0Â°\n2 / Numpad2 / Digit2 â€” RotaciÃ³n 90Â°\n3 / Numpad3 / Digit3 â€” RotaciÃ³n 180Â°\n4 / Numpad4 / Digit4 â€” RotaciÃ³n 270Â°\n8 / Numpad8 / Digit8 â€” Vista previa 3s\n9 / Numpad9 / Digit9 â€” Vista previa 10s\n0 / Numpad0 / Digit0 â€” Vista previa siempre (infinito)\nG â€” Ciclar guÃ­as de composiciÃ³n (Shift+G inverso)\nC â€” Cambiar color de guÃ­a\nEspacio â€” Alternar vista previa / volver a vista en vivo\nâ† / â†’ â€” Imagen previa anterior / siguiente\nF â€” Alternar pantalla completa\nH â€” Mostrar/ocultar esta ayuda\nA â€” Alternar rotaciÃ³n automÃ¡tica",
    },
    "it": {
        "app_title": "StudioTether",
        "status_not_connected": "Non connesso",
        "status_streaming": "Streaming", 
        "status_error": "Errore: {msg}",
        "snackbar_failed_connect": "Connessione fallita: {msg}",
        "status_disconnected": "Disconnesso",
        "status_io_busy": "I/O occupato, riprovo...",
        "status_disconnected_io": "Disconnesso (errori I/O)",
        "status_disconnected_device": "Disconnesso (dispositivo scollegato)",
        "status_disconnected_short": "Disconnesso: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "Rotazione 0Â° â€” tasto 1",
        "tooltip_rotation_90": "Rotazione 90Â° â€” tasto 2",
        "tooltip_rotation_180": "Rotazione 180Â° â€” tasto 3",
        "tooltip_rotation_270": "Rotazione 270Â° â€” tasto 4",
        "tooltip_autorotate": "Attiva/disattiva rotazione automatica",
        "preview_mode": "Anteprima",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "Anteprima 3 secondi â€” tasto 8",
        "tooltip_duration_10s": "Anteprima 10 secondi â€” tasto 9",
        "tooltip_duration_inf": "Anteprima sempre â€” tasto 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Nessuna guida â€” tasto G",
        "tooltip_guide_thirds": "Regola dei terzi â€” tasto G",
        "tooltip_guide_golden": "Sezione aurea â€” tasto G",
        "tooltip_guide_grid": "Griglia 3Ã—3 â€” tasto G",
        "tooltip_guide_diagonal": "Diagonali â€” tasto G",
        "tooltip_guide_center": "Croce centrale â€” tasto G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normal",
        "guide_fibonacci_variant_vflip": "Retourner â†”",
        "guide_fibonacci_variant_hflip": "Retourner â†•",
        "guide_fibonacci_variant_both": "Retourner â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Spirale di Fibonacci â€” tasto G",
        "tooltip_guide_triangles": "Triangoli d'oro â€” tasto G",
        "tooltip_guide_triangles_flip": "Triangoli d'oro invertiti â€” tasto G",
        "color_white_label": "B",
        "color_green_label": "V",
        "color_red_label": "R",
        "color_black_label": "N",
        "tooltip_color_white": "Guide bianche â€” tasto C",
        "tooltip_color_green": "Guide verdi â€” tasto C",
        "tooltip_color_red": "Guide rosse â€” tasto C",
        "tooltip_color_black": "Guide nere â€” tasto C",
        "help_text": "1 / Numpad1 / Digit1 â€” Rotazione 0Â°\n2 / Numpad2 / Digit2 â€” Rotazione 90Â°\n3 / Numpad3 / Digit3 â€” Rotazione 180Â°\n4 / Numpad4 / Digit4 â€” Rotazione 270Â°\n8 / Numpad8 / Digit8 â€” Anteprima 3s\n9 / Numpad9 / Digit9 â€” Anteprima 10s\n0 / Numpad0 / Digit0 â€” Anteprima sempre (infinito)\nG â€” Cambia guide di composizione (Shift+G indietro)\nC â€” Cambia colore guide\nSpazio â€” Alterna anteprima / torna alla visuale live\nâ† / â†’ â€” Precedente / Successivo (in modalitÃ  anteprima)\nF â€” Alterna modalitÃ  a schermo intero\nH â€” Mostra / nascondi questo aiuto\nA â€” Attiva/disattiva rotazione automatica",
    },
    "pt": {
        "app_title": "StudioTether",
        "status_not_connected": "NÃ£o conectado",
        "status_streaming": "Transmitindo", 
        "status_error": "Erro: {msg}",
        "snackbar_failed_connect": "Falha ao conectar: {msg}",
        "status_disconnected": "Desconectado",
        "status_io_busy": "E/S ocupada, tentando novamente...",
        "status_disconnected_io": "Desconectado (erros de E/S)",
        "status_disconnected_device": "Desconectado (dispositivo desconectado)",
        "status_disconnected_short": "Desconectado: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "RotaÃ§Ã£o 0Â° â€” tecla 1",
        "tooltip_rotation_90": "RotaÃ§Ã£o 90Â° â€” tecla 2",
        "tooltip_rotation_180": "RotaÃ§Ã£o 180Â° â€” tecla 3",
        "tooltip_rotation_270": "RotaÃ§Ã£o 270Â° â€” tecla 4",
        "tooltip_autorotate": "Alternar rotaÃ§Ã£o automÃ¡tica",
        "preview_mode": "PrÃ©-visualizaÃ§Ã£o",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "PrÃ©-visualizaÃ§Ã£o 3 segundos â€” tecla 8",
        "tooltip_duration_10s": "PrÃ©-visualizaÃ§Ã£o 10 segundos â€” tecla 9",
        "tooltip_duration_inf": "PrÃ©-visualizaÃ§Ã£o sempre â€” tecla 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Sem guias â€” tecla G",
        "tooltip_guide_thirds": "Regra dos terÃ§os â€” tecla G",
        "tooltip_guide_golden": "ProporÃ§Ã£o Ã¡urea â€” tecla G",
        "tooltip_guide_grid": "Grade 3Ã—3 â€” tecla G",
        "tooltip_guide_diagonal": "Diagonais â€” tecla G",
        "tooltip_guide_center": "Cruz central â€” tecla G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normal",
        "guide_fibonacci_variant_vflip": "Voltear â†”",
        "guide_fibonacci_variant_hflip": "Voltear â†•",
        "guide_fibonacci_variant_both": "Voltear â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Espiral de Fibonacci â€” tecla G",
        "tooltip_guide_triangles": "TriÃ¢ngulos dourados â€” tecla G",
        "tooltip_guide_triangles_flip": "TriÃ¢ngulos dourados invertidos â€” tecla G",
        "color_white_label": "B",
        "color_green_label": "V",
        "color_red_label": "V",
        "color_black_label": "P",
        "tooltip_color_white": "Guias brancas â€” tecla C",
        "tooltip_color_green": "Guias verdes â€” tecla C",
        "tooltip_color_red": "Guias vermelhas â€” tecla C",
        "tooltip_color_black": "Guias pretas â€” tecla C",
        "help_text": "1 / Numpad1 / Digit1 â€” PrÃ©-visualizaÃ§Ã£o 0Â°\n2 / Numpad2 / Digit2 â€” PrÃ©-visualizaÃ§Ã£o 90Â°\n3 / Numpad3 / Digit3 â€” PrÃ©-visualizaÃ§Ã£o 180Â°\n4 / Numpad4 / Digit4 â€” PrÃ©-visualizaÃ§Ã£o 270Â°\n8 / Numpad8 / Digit8 â€” PrÃ©-visualizaÃ§Ã£o 3s\n9 / Numpad9 / Digit9 â€” PrÃ©-visualizaÃ§Ã£o 10s\n0 / Numpad0 / Digit0 â€” PrÃ©-visualizaÃ§Ã£o sempre (infinito)\nG â€” Alternar guias de composiÃ§Ã£o (Shift+G inverso)\nC â€” Alternar cor das guias\nEspaÃ§o â€” Alternar prÃ©-visualizaÃ§Ã£o / voltar para live\nâ† / â†’ â€” Anterior / PrÃ³xima imagem de prÃ©-visualizaÃ§Ã£o\nF â€” Alternar ecrÃ£ completo\nH â€” Mostrar/ocultar esta ajuda\nA â€” Alternar rotaÃ§Ã£o automÃ¡tica",
    },
    "ru": {
        "app_title": "StudioTether",
        "status_not_connected": "ÐÐµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾",
        "status_streaming": "Ð¢Ñ€Ð°Ð½ÑÐ»ÑÑ†Ð¸Ñ", 
        "status_error": "ÐžÑˆÐ¸Ð±ÐºÐ°: {msg}",
        "snackbar_failed_connect": "ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ: {msg}",
        "status_disconnected": "ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾",
        "status_io_busy": "Ð£ÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾ Ð·Ð°Ð½ÑÑ‚Ð¾, Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€...",
        "status_disconnected_io": "ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾ (Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð²Ð²Ð¾Ð´Ð°-Ð²Ñ‹Ð²Ð¾Ð´Ð°)",
        "status_disconnected_device": "ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾ (ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾ Ð¾Ñ‚ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¾)",
        "status_disconnected_short": "ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 0Â° â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 1",
        "tooltip_rotation_90": "ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 90Â° â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 2",
        "tooltip_rotation_180": "ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 180Â° â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 3",
        "tooltip_rotation_270": "ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 270Â° â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 4",
        "preview_mode": "ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3Ñ",
        "duration_10s_label": "10Ñ",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ 3 ÑÐµÐºÑƒÐ½Ð´Ñ‹ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 8",
        "tooltip_duration_10s": "ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ 10 ÑÐµÐºÑƒÐ½Ð´ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 9",
        "tooltip_duration_inf": "ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð²ÑÐµÐ³Ð´Ð° â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Ð‘ÐµÐ· Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ñ… â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_thirds": "ÐŸÑ€Ð°Ð²Ð¸Ð»Ð¾ Ñ‚Ñ€ÐµÑ‚ÐµÐ¹ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_golden": "Ð—Ð¾Ð»Ð¾Ñ‚Ð¾Ðµ ÑÐµÑ‡ÐµÐ½Ð¸Ðµ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_grid": "Ð¡ÐµÑ‚ÐºÐ° 3Ã—3 â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_diagonal": "Ð”Ð¸Ð°Ð³Ð¾Ð½Ð°Ð»Ð¸ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_center": "Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÑ€ÐµÑÑ‚ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normale",
        "guide_fibonacci_variant_vflip": "Capovolgi â†”",
        "guide_fibonacci_variant_hflip": "Capovolgi â†•",
        "guide_fibonacci_variant_both": "Capovolgi â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Ð¡Ð¿Ð¸Ñ€Ð°Ð»ÑŒ Ð¤Ð¸Ð±Ð¾Ð½Ð°Ñ‡Ñ‡Ð¸ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_triangles": "Ð—Ð¾Ð»Ð¾Ñ‚Ñ‹Ðµ Ñ‚Ñ€ÐµÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ¸ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "tooltip_guide_triangles_flip": "Ð—Ð¾Ð»Ð¾Ñ‚Ñ‹Ðµ Ñ‚Ñ€ÐµÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ¸ Ð·ÐµÑ€ÐºÐ°Ð»ÑŒÐ½Ñ‹Ðµ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° G",
        "color_white_label": "Ð‘",
        "color_green_label": "Ð—",
        "color_red_label": "Ðš",
        "color_black_label": "Ð§",
        "tooltip_color_white": "Ð‘ÐµÐ»Ñ‹Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ðµ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° C",
        "tooltip_color_green": "Ð—ÐµÐ»Ñ‘Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ðµ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° C",
        "tooltip_color_red": "ÐšÑ€Ð°ÑÐ½Ñ‹Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ðµ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° C",
        "tooltip_color_black": "Ð§Ñ‘Ñ€Ð½Ñ‹Ðµ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ðµ â€” ÐºÐ»Ð°Ð²Ð¸ÑˆÐ° C",
        "tooltip_autorotate": "Ð’ÐºÐ»/Ð²Ñ‹ÐºÐ» Ð°Ð²Ñ‚Ð¾-Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚",
        "help_text": "1 / Numpad1 / Digit1 â€” ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 0Â°\n2 / Numpad2 / Digit2 â€” ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 90Â°\n3 / Numpad3 / Digit3 â€” ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 180Â°\n4 / Numpad4 / Digit4 â€” ÐŸÐ¾Ð²Ð¾Ñ€Ð¾Ñ‚ 270Â°\n8 / Numpad8 / Digit8 â€” ÐŸÑ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ 3s\n9 / Numpad9 / Digit9 â€” ÐŸÑ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ 10s\n0 / Numpad0 / Digit0 â€” ÐŸÑ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð²ÑÐµÐ³Ð´Ð° (Ð±ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ð¾)\nG â€” ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ðµ (Shift+G Ð½Ð°Ð·Ð°Ð´)\nC â€” Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ†Ð²ÐµÑ‚ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‰Ð¸Ñ…\nÐŸÑ€Ð¾Ð±ÐµÐ» â€” ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ / Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚ Ðº Ð¶Ð¸Ð²Ð¾Ð¼Ñƒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ñƒ\nâ† / â†’ â€” ÐŸÑ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð°Ñ / Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð°Ñ Ð¿Ñ€ÐµÐ²ÑŒÑŽ-Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ\nF â€” ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼\nH â€” ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ/ÑÐºÑ€Ñ‹Ñ‚ÑŒ ÑÑ‚Ñƒ ÑÐ¿Ñ€Ð°Ð²ÐºÑƒ\nA â€” Ð’ÐºÐ»/Ð²Ñ‹ÐºÐ» Ð°Ð²Ñ‚Ð¾-Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚",
    },
    "ja": {
        "app_title": "StudioTether",
        "status_not_connected": "æœªæŽ¥ç¶š",
        "status_streaming": "é…ä¿¡ä¸­", 
        "status_error": "ã‚¨ãƒ©ãƒ¼: {msg}",
        "snackbar_failed_connect": "æŽ¥ç¶šå¤±æ•—: {msg}",
        "status_disconnected": "åˆ‡æ–­ã•ã‚Œã¾ã—ãŸ",
        "status_io_busy": "I/O ãƒ“ã‚¸ãƒ¼ã€å†è©¦è¡Œä¸­...",
        "status_disconnected_io": "åˆ‡æ–­ã•ã‚Œã¾ã—ãŸ (I/O ã‚¨ãƒ©ãƒ¼)",
        "status_disconnected_device": "åˆ‡æ–­ã•ã‚Œã¾ã—ãŸ (ãƒ‡ãƒã‚¤ã‚¹æœªæŽ¥ç¶š)",
        "status_disconnected_short": "åˆ‡æ–­ã•ã‚Œã¾ã—ãŸ: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "å›žè»¢ 0Â° â€” ã‚­ãƒ¼ 1",
        "tooltip_rotation_90": "å›žè»¢ 90Â° â€” ã‚­ãƒ¼ 2",
        "tooltip_rotation_180": "å›žè»¢ 180Â° â€” ã‚­ãƒ¼ 3",
        "tooltip_rotation_270": "å›žè»¢ 270Â° â€” ã‚­ãƒ¼ 4",
        "tooltip_autorotate": "è‡ªå‹•å›žè»¢ã‚’åˆ‡ã‚Šæ›¿ãˆ",
        "preview_mode": "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3ç§’",
        "duration_10s_label": "10ç§’",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ 3ç§’ â€” ã‚­ãƒ¼ 8",
        "tooltip_duration_10s": "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ 10ç§’ â€” ã‚­ãƒ¼ 9",
        "tooltip_duration_inf": "ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ å¸¸ã« â€” ã‚­ãƒ¼ 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "ã‚¬ã‚¤ãƒ‰ãªã— â€” ã‚­ãƒ¼ G",
        "tooltip_guide_thirds": "ä¸‰åˆ†å‰²æ³• â€” ã‚­ãƒ¼ G",
        "tooltip_guide_golden": "é»„é‡‘æ¯” â€” ã‚­ãƒ¼ G",
        "tooltip_guide_grid": "ã‚°ãƒªãƒƒãƒ‰ 3Ã—3 â€” ã‚­ãƒ¼ G",
        "tooltip_guide_diagonal": "å¯¾è§’ç·š â€” ã‚­ãƒ¼ G",
        "tooltip_guide_center": "ä¸­å¿ƒã‚¯ãƒ­ã‚¹ â€” ã‚­ãƒ¼ G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "é€šå¸¸",
        "guide_fibonacci_variant_vflip": "åè»¢ â†”",
        "guide_fibonacci_variant_hflip": "åè»¢ â†•",
        "guide_fibonacci_variant_both": "åè»¢ â†”â†•",
        "color_white_label": "ç™½",
        "color_green_label": "ç·‘",
        "color_red_label": "èµ¤",
        "color_black_label": "é»’",
        "tooltip_color_white": "ç™½ã„ã‚¬ã‚¤ãƒ‰ â€” ã‚­ãƒ¼ C",
        "tooltip_color_green": "ç·‘ã®ã‚¬ã‚¤ãƒ‰ â€” ã‚­ãƒ¼ C",
        "tooltip_color_red": "èµ¤ã„ã‚¬ã‚¤ãƒ‰ â€” ã‚­ãƒ¼ C",
        "tooltip_color_black": "é»’ã„ã‚¬ã‚¤ãƒ‰ â€” ã‚­ãƒ¼ C",
        "help_text": "1 / Numpad1 / Digit1 â€” å›žè»¢ 0Â°\n2 / Numpad2 / Digit2 â€” å›žè»¢ 90Â°\n3 / Numpad3 / Digit3 â€” å›žè»¢ 180Â°\n4 / Numpad4 / Digit4 â€” å›žè»¢ 270Â°\n8 / Numpad8 / Digit8 â€” ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ 3ç§’\n9 / Numpad9 / Digit9 â€” ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ 10ç§’\n0 / Numpad0 / Digit0 â€” å¸¸ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆç„¡é™ï¼‰\nG â€” ã‚¬ã‚¤ãƒ‰ã‚’åˆ‡æ›¿ï¼ˆShift+G é€†ï¼‰\nC â€” ã‚¬ã‚¤ãƒ‰è‰²ã‚’åˆ‡æ›¿\nSpace â€” ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åˆ‡æ›¿ / ãƒ©ã‚¤ãƒ–ã«æˆ»ã‚‹\nâ† / â†’ â€” å‰/æ¬¡ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ï¼‰\nF â€” å…¨ç”»é¢åˆ‡æ›¿\nH â€” ã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º/éžè¡¨ç¤º\nA â€” è‡ªå‹•å›žè»¢ã‚’åˆ‡ã‚Šæ›¿ãˆ",
    },
    "zh": {
        "app_title": "StudioTether",
        "status_not_connected": "æœªè¿žæŽ¥",
        "status_streaming": "æ­£åœ¨ä¼ è¾“", 
        "status_error": "é”™è¯¯ï¼š{msg}",
        "snackbar_failed_connect": "è¿žæŽ¥å¤±è´¥ï¼š{msg}",
        "status_disconnected": "å·²æ–­å¼€",
        "status_io_busy": "I/O ç¹å¿™ï¼Œæ­£åœ¨é‡è¯•...",
        "status_disconnected_io": "å·²æ–­å¼€ï¼ˆI/O é”™è¯¯ï¼‰",
        "status_disconnected_device": "å·²æ–­å¼€ï¼ˆè®¾å¤‡å·²æ‹”å‡ºï¼‰",
        "status_disconnected_short": "å·²æ–­å¼€ï¼š{short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "æ—‹è½¬ 0Â° â€” æŒ‰é”® 1",
        "tooltip_rotation_90": "æ—‹è½¬ 90Â° â€” æŒ‰é”® 2",
        "tooltip_rotation_180": "æ—‹è½¬ 180Â° â€” æŒ‰é”® 3",
        "tooltip_rotation_270": "æ—‹è½¬ 270Â° â€” æŒ‰é”® 4",
        "tooltip_autorotate": "åˆ‡æ¢è‡ªåŠ¨æ—‹è½¬",
        "preview_mode": "é¢„è§ˆ",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3ç§’",
        "duration_10s_label": "10ç§’",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "é¢„è§ˆ 3ç§’ â€” æŒ‰é”® 8",
        "tooltip_duration_10s": "é¢„è§ˆ 10ç§’ â€” æŒ‰é”® 9",
        "tooltip_duration_inf": "é¢„è§ˆ å§‹ç»ˆ â€” æŒ‰é”® 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "æ— å‚è€ƒçº¿ â€” æŒ‰é”® G",
        "tooltip_guide_thirds": "ä¸‰åˆ†æ³• â€” æŒ‰é”® G",
        "tooltip_guide_golden": "é»„é‡‘åˆ†å‰² â€” æŒ‰é”® G",
        "tooltip_guide_grid": "ç½‘æ ¼ 3Ã—3 â€” æŒ‰é”® G",
        "tooltip_guide_diagonal": "å¯¹è§’çº¿ â€” æŒ‰é”® G",
        "tooltip_guide_center": "ä¸­å¿ƒåå­— â€” æŒ‰é”® G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "æ­£å¸¸",
        "guide_fibonacci_variant_vflip": "å·¦å³ç¿»è½¬ â†”",
        "guide_fibonacci_variant_hflip": "ä¸Šä¸‹ç¿»è½¬ â†•",
        "guide_fibonacci_variant_both": "åŒæ—¶ç¿»è½¬ â†”â†•",
        "color_white_label": "ç™½",
        "color_green_label": "ç»¿",
        "color_red_label": "çº¢",
        "color_black_label": "é»‘",
        "tooltip_color_white": "ç™½è‰²å‚è€ƒçº¿ â€” æŒ‰é”® C",
        "tooltip_color_green": "ç»¿è‰²å‚è€ƒçº¿ â€” æŒ‰é”® C",
        "tooltip_color_red": "çº¢è‰²å‚è€ƒçº¿ â€” æŒ‰é”® C",
        "tooltip_color_black": "é»‘è‰²å‚è€ƒçº¿ â€” æŒ‰é”® C",
        "help_text": "1 / Numpad1 / Digit1 â€” æ—‹è½¬ 0Â°\n2 / Numpad2 / Digit2 â€” æ—‹è½¬ 90Â°\n3 / Numpad3 / Digit3 â€” æ—‹è½¬ 180Â°\n4 / Numpad4 / Digit4 â€” æ—‹è½¬ 270Â°\n8 / Numpad8 / Digit8 â€” é¢„è§ˆ 3ç§’\n9 / Numpad9 / Digit9 â€” é¢„è§ˆ 10ç§’\n0 / Numpad0 / Digit0 â€” å§‹ç»ˆé¢„è§ˆï¼ˆæ— é™ï¼‰\nG â€” åˆ‡æ¢æž„å›¾å¯¼çº¿ï¼ˆShift+G åå‘ï¼‰\nC â€” åˆ‡æ¢å¯¼çº¿é¢œè‰²\nç©ºæ ¼ â€” åˆ‡æ¢é¢„è§ˆ / è¿”å›žå®žæ—¶è§†å›¾\nâ† / â†’ â€” ä¸Šä¸€å¼  / ä¸‹ä¸€å¼ é¢„è§ˆå›¾åƒ\nF â€” åˆ‡æ¢å…¨å±æ¨¡å¼\nH â€” æ˜¾ç¤º/éšè—æ­¤å¸®åŠ©\nA â€” åˆ‡æ¢è‡ªåŠ¨æ—‹è½¬",
    },
    "nl": {
        "app_title": "StudioTether",
        "status_not_connected": "Niet verbonden",
        "status_streaming": "Streaming", 
        "status_error": "Fout: {msg}",
        "snackbar_failed_connect": "Verbinding mislukt: {msg}",
        "status_disconnected": "Verbinding verbroken",
        "status_io_busy": "I/O bezet, opnieuw proberen...",
        "status_disconnected_io": "Verbinding verbroken (I/O-fouten)",
        "status_disconnected_device": "Verbinding verbroken (apparaat losgekoppeld)",
        "status_disconnected_short": "Verbinding verbroken: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "Rotatie 0Â° â€” toets 1",
        "tooltip_rotation_90": "Rotatie 90Â° â€” toets 2",
        "tooltip_rotation_180": "Rotatie 180Â° â€” toets 3",
        "tooltip_rotation_270": "Rotatie 270Â° â€” toets 4",
        "tooltip_autorotate": "Auto-rotatie in-/uitschakelen",
        "preview_mode": "Voorbeeld",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "Voorbeeld 3 seconden â€” toets 8",
        "tooltip_duration_10s": "Voorbeeld 10 seconden â€” toets 9",
        "tooltip_duration_inf": "Voorbeeld altijd â€” toets 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Geen hulplijnen â€” toets G",
        "tooltip_guide_thirds": "Regel van derden â€” toets G",
        "tooltip_guide_golden": "Gulden snede â€” toets G",
        "tooltip_guide_grid": "Raster 3Ã—3 â€” toets G",
        "tooltip_guide_diagonal": "Diagonalen â€” toets G",
        "tooltip_guide_center": "Middenkruis â€” toets G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normal",
        "guide_fibonacci_variant_vflip": "Virar â†”",
        "guide_fibonacci_variant_hflip": "Virar â†•",
        "guide_fibonacci_variant_both": "Virar â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Fibonacci-spiraal â€” toets G",
        "tooltip_guide_triangles": "Gouden driehoeken â€” toets G",
        "tooltip_guide_triangles_flip": "Gouden driehoeken gespiegeld â€” toets G",
        "color_white_label": "W",
        "color_green_label": "G",
        "color_red_label": "R",
        "color_black_label": "Z",
        "tooltip_color_white": "Witte hulplijnen â€” toets C",
        "tooltip_color_green": "Groene hulplijnen â€” toets C",
        "tooltip_color_red": "Rode hulplijnen â€” toets C",
        "tooltip_color_black": "Zwarte hulplijnen â€” toets C",
        "help_text": "1 / Numpad1 / Digit1 â€” Rotatie 0Â°\n2 / Numpad2 / Digit2 â€” Rotatie 90Â°\n3 / Numpad3 / Digit3 â€” Rotatie 180Â°\n4 / Numpad4 / Digit4 â€” Rotatie 270Â°\n8 / Numpad8 / Digit8 â€” Voorbeeld 3s\n9 / Numpad9 / Digit9 â€” Voorbeeld 10s\n0 / Numpad0 / Digit0 â€” Voorbeeld altijd (oneindig)\nG â€” Wissel compositiehulpmiddelen (Shift+G terug)\nC â€” Wissel hulpkleur\nSpatie â€” Wissel voorbeeld / terug naar live-weergave\nâ† / â†’ â€” Vorige / Volgende voorbeeldafbeelding\nF â€” Wissel volledig scherm\nH â€” Toon / verberg deze hulp\nA â€” Auto-rotatie in-/uitschakelen",
    },
    "sv": {
        "app_title": "StudioTether",
        "status_not_connected": "Ej ansluten",
        "status_streaming": "StrÃ¶mmar", 
        "status_error": "Fel: {msg}",
        "snackbar_failed_connect": "Anslutning misslyckades: {msg}",
        "status_disconnected": "FrÃ¥nkopplad",
        "status_io_busy": "I/O upptagen, fÃ¶rsÃ¶ker igen...",
        "status_disconnected_io": "FrÃ¥nkopplad (I/O-fel)",
        "status_disconnected_device": "FrÃ¥nkopplad (enhet frÃ¥nkopplad)",
        "status_disconnected_short": "FrÃ¥nkopplad: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "Rotation 0Â° â€” tangent 1",
        "tooltip_rotation_90": "Rotation 90Â° â€” tangent 2",
        "tooltip_rotation_180": "Rotation 180Â° â€” tangent 3",
        "tooltip_rotation_270": "Rotation 270Â° â€” tangent 4",
        "tooltip_autorotate": "VÃ¤xla automatisk rotation",
        "preview_mode": "FÃ¶rhandsgranskning",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3s",
        "duration_10s_label": "10s",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "FÃ¶rhandsgranskning 3 sekunder â€” tangent 8",
        "tooltip_duration_10s": "FÃ¶rhandsgranskning 10 sekunder â€” tangent 9",
        "tooltip_duration_inf": "FÃ¶rhandsgranskning alltid â€” tangent 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "Inga hjÃ¤lplinjer â€” tangent G",
        "tooltip_guide_thirds": "Tredjedelsregeln â€” tangent G",
        "tooltip_guide_golden": "Gyllene snittet â€” tangent G",
        "tooltip_guide_grid": "RutnÃ¤t 3Ã—3 â€” tangent G",
        "tooltip_guide_diagonal": "Diagonaler â€” tangent G",
        "tooltip_guide_center": "Mittkors â€” tangent G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "Normal",
        "guide_fibonacci_variant_vflip": "SpegelvÃ¤nd â†”",
        "guide_fibonacci_variant_hflip": "SpegelvÃ¤nd â†•",
        "guide_fibonacci_variant_both": "SpegelvÃ¤nd â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "Fibonacci-spiral â€” tangent G",
        "tooltip_guide_triangles": "Gyllene trianglar â€” tangent G",
        "tooltip_guide_triangles_flip": "Gyllene trianglar speglade â€” tangent G",
        "color_white_label": "V",
        "color_green_label": "G",
        "color_red_label": "R",
        "color_black_label": "S",
        "tooltip_color_white": "Vita hjÃ¤lplinjer â€” tangent C",
        "tooltip_color_green": "GrÃ¶na hjÃ¤lplinjer â€” tangent C",
        "tooltip_color_red": "RÃ¶da hjÃ¤lplinjer â€” tangent C",
        "tooltip_color_black": "Svarta hjÃ¤lplinjer â€” tangent C",
        "help_text": "1 / Numpad1 / Digit1 â€” Rotation 0Â°\n2 / Numpad2 / Digit2 â€” Rotation 90Â°\n3 / Numpad3 / Digit3 â€” Rotation 180Â°\n4 / Numpad4 / Digit4 â€” Rotation 270Â°\n8 / Numpad8 / Digit8 â€” FÃ¶rhandsvisning 3s\n9 / Numpad9 / Digit9 â€” FÃ¶rhandsvisning 10s\n0 / Numpad0 / Digit0 â€” FÃ¶rhandsvisning alltid (oÃ¤ndlig)\nG â€” VÃ¤xla kompositionsguider (Shift+G bakÃ¥t)\nC â€” VÃ¤xla guidefÃ¤rg\nMellanslag â€” VÃ¤xla fÃ¶rhandsvisning / Ã¥tergÃ¥ till livevy\nâ† / â†’ â€” FÃ¶regÃ¥ende / NÃ¤sta fÃ¶rhandsvisningsbild\nF â€” VÃ¤xla helskÃ¤rm\nH â€” Visa / dÃ¶lj denna hjÃ¤lp\nA â€” VÃ¤xla automatisk rotation",
    },
    "ko": {
        "app_title": "StudioTether",
        "status_not_connected": "ì—°ê²° ì•ˆ ë¨",
        "status_streaming": "ìŠ¤íŠ¸ë¦¬ë° ì¤‘", 
        "status_error": "ì˜¤ë¥˜: {msg}",
        "snackbar_failed_connect": "ì—°ê²° ì‹¤íŒ¨: {msg}",
        "status_disconnected": "ì—°ê²° ëŠê¹€",
        "status_io_busy": "I/O ì‚¬ìš© ì¤‘, ìž¬ì‹œë„ ì¤‘...",
        "status_disconnected_io": "ì—°ê²° ëŠê¹€ (I/O ì˜¤ë¥˜)",
        "status_disconnected_device": "ì—°ê²° ëŠê¹€ (ìž¥ì¹˜ ë¶„ë¦¬ë¨)",
        "status_disconnected_short": "ì—°ê²° ëŠê¹€: {short}",
        "rotate_0_label": "0Â°",
        "rotate_90_label": "90Â°",
        "rotate_180_label": "180Â°",
        "rotate_270_label": "270Â°",
        "tooltip_rotation_0": "íšŒì „ 0Â° â€” í‚¤ 1",
        "tooltip_rotation_90": "íšŒì „ 90Â° â€” í‚¤ 2",
        "tooltip_rotation_180": "íšŒì „ 180Â° â€” í‚¤ 3",
        "tooltip_rotation_270": "íšŒì „ 270Â° â€” í‚¤ 4",
        "tooltip_autorotate": "ìžë™ íšŒì „ ì „í™˜",
        "preview_mode": "ë¯¸ë¦¬ë³´ê¸°",
        "preview_counter": "{current} / {total}",
        "duration_3s_label": "3ì´ˆ",
        "duration_10s_label": "10ì´ˆ",
        "duration_inf_label": "âˆž",
        "tooltip_duration_3s": "ë¯¸ë¦¬ë³´ê¸° 3ì´ˆ â€” í‚¤ 8",
        "tooltip_duration_10s": "ë¯¸ë¦¬ë³´ê¸° 10ì´ˆ â€” í‚¤ 9",
        "tooltip_duration_inf": "ë¯¸ë¦¬ë³´ê¸° í•­ìƒ â€” í‚¤ 0",
        "guide_none_label": "â»",
        "guide_thirds_label": "â…“",
        "guide_golden_label": "Ï†",
        "guide_grid_label": "â–¦",
        "guide_diagonal_label": "â•³",
        "guide_center_label": "+",
        "tooltip_guide_none": "ê°€ì´ë“œ ì—†ìŒ â€” í‚¤ G",
        "tooltip_guide_thirds": "ì‚¼ë¶„í•  ë²•ì¹™ â€” í‚¤ G",
        "tooltip_guide_golden": "í™©ê¸ˆ ë¹„ìœ¨ â€” í‚¤ G",
        "tooltip_guide_grid": "ê·¸ë¦¬ë“œ 3Ã—3 â€” í‚¤ G",
        "tooltip_guide_diagonal": "ëŒ€ê°ì„  â€” í‚¤ G",
        "tooltip_guide_center": "ì¤‘ì•™ ì‹­ìž â€” í‚¤ G",
        "guide_fibonacci_label": "ðŸŒ€",
        "guide_fibonacci_variant_normal": "í‘œì¤€",
        "guide_fibonacci_variant_vflip": "ë’¤ì§‘ê¸° â†”",
        "guide_fibonacci_variant_hflip": "ë’¤ì§‘ê¸° â†•",
        "guide_fibonacci_variant_both": "ë’¤ì§‘ê¸° â†”â†•",
        "guide_triangles_label": "â–³",
        "guide_triangles_flip_label": "â–³â†”",
        "tooltip_guide_fibonacci": "í”¼ë³´ë‚˜ì¹˜ ë‚˜ì„  â€” í‚¤ G",
        "tooltip_guide_triangles": "í™©ê¸ˆ ì‚¼ê°í˜• â€” í‚¤ G",
        "tooltip_guide_triangles_flip": "í™©ê¸ˆ ì‚¼ê°í˜• ë°˜ì „ â€” í‚¤ G",        "color_white_label": "í¬",
        "color_green_label": "ë…¹",
        "color_red_label": "ì ",
        "color_black_label": "í‘",
        "tooltip_color_white": "í¬ìƒ‰ ê°€ì´ë“œ â€” í‚¤ C",
        "tooltip_color_green": "ë…¹ìƒ‰ ê°€ì´ë“œ â€” í‚¤ C",
        "tooltip_color_red": "ì ìƒ‰ ê°€ì´ë“œ â€” í‚¤ C",
        "tooltip_color_black": "í‘ìƒ‰ ê°€ì´ë“œ â€” í‚¤ C",
        "help_text": "1 / Numpad1 / Digit1 â€” íšŒì „ 0Â°\n2 / Numpad2 / Digit2 â€” íšŒì „ 90Â°\n3 / Numpad3 / Digit3 â€” íšŒì „ 180Â°\n4 / Numpad4 / Digit4 â€” íšŒì „ 270Â°\n8 / Numpad8 / Digit8 â€” ë¯¸ë¦¬ë³´ê¸° 3ì´ˆ\n9 / Numpad9 / Digit9 â€” ë¯¸ë¦¬ë³´ê¸° 10ì´ˆ\n0 / Numpad0 / Digit0 â€” í•­ìƒ ë¯¸ë¦¬ë³´ê¸° (ë¬´í•œ)\nG â€” ê°€ì´ë“œ ìˆœí™˜ (Shift+G ì—­ë°©í–¥)\nC â€” ê°€ì´ë“œ ìƒ‰ìƒ ë³€ê²½\nìŠ¤íŽ˜ì´ìŠ¤ â€” ë¯¸ë¦¬ë³´ê¸° ì „í™˜ / ë¼ì´ë¸Œë¡œ ëŒì•„ê°€ê¸°\nâ† / â†’ â€” ì´ì „ / ë‹¤ìŒ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€\nF â€” ì „ì²´í™”ë©´ ì „í™˜\nH â€” ì´ ë„ì›€ë§ í‘œì‹œ/ìˆ¨ê¸°ê¸°\nA â€” ìžë™ íšŒì „ ì „í™˜",
    },
}


def set_locale(locale: str) -> bool:
    """Set the active locale for translations.

    Normalizes values like "en_US" or "en-US" to the primary subtag ("en").
    Returns True when a supported locale was selected, False otherwise.
    """
    global _locale
    if not locale:
        return False
    # Normalize language code to primary subtag, lowercase
    code = str(locale).split('.')[0].replace('_', '-').split('-')[0].lower()
    if code in TRANSLATIONS:
        _locale = code
        return True
    return False


def t(key: str, **kwargs) -> str:
    """Translate a key using the active locale and format with kwargs.

    If a translation is missing, falls back to the key itself.
    """
    strings = TRANSLATIONS.get(_locale, TRANSLATIONS[DEFAULT_LOCALE])
    template = strings.get(key, key)
    try:
        return template.format(**kwargs)
    except Exception:
        return template


def is_supported(locale: str) -> bool:
    """Return True if the provided locale (or primary subtag) is supported."""
    if not locale:
        return False
    code = str(locale).split('.')[0].replace('_', '-').split('-')[0].lower()
    return code in TRANSLATIONS


def get_system_locale() -> str:
    """Detect the system locale in a cross-platform way and return its primary language subtag.

    Strategy (in order):
    1. Python's locale module (standard, cross-platform)
    2. Platform-specific methods if locale module returns C/POSIX:
       - macOS: Read AppleLanguages via defaults command
       - Windows: Use GetUserDefaultUILanguage Win32 API
       - Linux: Environment variables (LC_ALL, LC_MESSAGES, LANG, LANGUAGE)
    3. If all fail: return DEFAULT_LOCALE
    """
    import os
    import sys
    import locale

    # === Try Python's standard locale module first ===
    try:
        loc_tuple = locale.getlocale(locale.LC_MESSAGES)
        if not loc_tuple or not loc_tuple[0]:
            loc_tuple = locale.getlocale()
        if loc_tuple and loc_tuple[0]:
            loc_str = str(loc_tuple[0])
            if loc_str.lower() not in ('c', 'posix', 'none'):
                primary = loc_str.split('.')[0].replace('_', '-').split('-')[0].lower()
                if primary and primary not in ('c', 'posix'):
                    return primary
    except Exception:
        pass

    # === Environment variables (Linux/macOS fallback) ===
    for env_var in ("LC_ALL", "LC_MESSAGES", "LANG", "LANGUAGE"):
        val = os.environ.get(env_var)
        if val and val.lower() not in ('c', 'posix', 'c.utf-8', 'c.utf8'):
            try:
                primary = val.split('.')[0].replace('_', '-').split('-')[0].lower()
                if primary and primary not in ('c', 'posix'):
                    return primary
            except Exception:
                pass

    # === macOS-specific fallback ===
    if sys.platform == "darwin":
        try:
            import subprocess
            result = subprocess.run(
                ['defaults', 'read', '-g', 'AppleLanguages'],
                capture_output=True,
                text=True,
                timeout=2
            )
            if result.returncode == 0:
                output = result.stdout.strip()
                langs = output.replace('(', '').replace(')', '').replace('"', '').replace('\n', ',')
                first_lang = [l.strip() for l in langs.split(',') if l.strip()][0]
                if first_lang and first_lang.lower() not in ('c', 'posix'):
                    primary = first_lang.split('.')[0].replace('_', '-').split('-')[0].lower()
                    return primary
        except Exception:
            pass

    # === Windows-specific fallback ===
    if sys.platform == "win32":
        try:
            import ctypes
            windll = ctypes.windll.kernel32
            langid = windll.GetUserDefaultUILanguage()
            primary_lang = langid & 0x3FF
            lang_map = {
                0x09: "en", 0x07: "de", 0x0C: "fr", 0x0A: "es", 0x15: "pl",
                0x10: "it", 0x16: "pt", 0x11: "ja", 0x04: "zh", 0x19: "ru",
                0x13: "nl", 0x1D: "sv", 0x12: "ko",
            }
            if primary_lang in lang_map:
                return lang_map[primary_lang]
        except Exception:
            pass

    return DEFAULT_LOCALE


# Initialize default locale from the system when the module is imported.
try:
    set_locale(get_system_locale())
except Exception:
    pass
